cmake_minimum_required (VERSION 3.0.2)
project (all_vmods C)

if (VARNISH_PLUS)
	option(VMOD_JWT "Build the JWT VMOD" ON)
	option(VMOD_WAF "Build the WAF VMOD" OFF)
endif()

if (VARNISH_PLUS)
	add_subdirectory(accept)
	add_subdirectory(blob)
else()
	#add_subdirectory(bodyaccess)
endif()
add_subdirectory(cookie)
if (VARNISH_PLUS)
	add_subdirectory(debug)
	add_subdirectory(directors)
endif()
add_subdirectory(example)
add_subdirectory(header)
if (VARNISH_PLUS)
	if (VMOD_USE_LOCAL_VC)
		# can only be built with VC present
		add_subdirectory(std)
	endif()
	add_subdirectory(purge)
	add_subdirectory(urlplus)
	add_subdirectory(libvjson)
	if (VMOD_JWT)
		add_subdirectory(jwt)
	endif()
	if (VMOD_WAF)
		add_subdirectory(waf)
	endif()
endif()

enable_testing()
