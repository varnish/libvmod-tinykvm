varnishtest ".check_req() survives NULL strings"

server s1 {
	rxreq
	txresp -hdr "obj: 1"
} -start


varnish v1 -vcl+backend {

	import std;
	import waf;

	sub vcl_init {
		new waf_crs = waf.init();
	}


	sub vcl_backend_fetch {
		waf_crs.init_transaction();
		waf_crs.check_req(bereq.http.null, 1111);
	}
} -start

client c1 {
	txreq -url "/foo"
	rxresp
	expect resp.status == 200
} -run
