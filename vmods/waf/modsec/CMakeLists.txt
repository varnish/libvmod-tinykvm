project (ModSecurity CXX)

add_subdirectory(mbedtls)
add_subdirectory(libinjection)

set(SOURCES
	ModSecurity/src/rules_exceptions.cc
	ModSecurity/src/anchored_variable.cc
	ModSecurity/src/operators/detect_xss.cc
	ModSecurity/src/operators/pm.cc
	ModSecurity/src/operators/validate_utf8_encoding.cc
	ModSecurity/src/operators/no_match.cc
	ModSecurity/src/operators/verify_ssn.cc
	ModSecurity/src/operators/str_eq.cc
	ModSecurity/src/operators/ip_match_f.cc
	ModSecurity/src/operators/operator.cc
	ModSecurity/src/operators/validate_hash.cc
	ModSecurity/src/operators/ip_match_from_file.cc
	ModSecurity/src/operators/verify_cc.cc
	ModSecurity/src/operators/gt.cc
	ModSecurity/src/operators/unconditional_match.cc
	ModSecurity/src/operators/fuzzy_hash.cc
	ModSecurity/src/operators/le.cc
	ModSecurity/src/operators/validate_schema.cc
	ModSecurity/src/operators/verify_cpf.cc
	ModSecurity/src/operators/contains.cc
	ModSecurity/src/operators/gsblookup.cc
	ModSecurity/src/operators/rsub.cc
	ModSecurity/src/operators/geo_lookup.cc
	ModSecurity/src/operators/lt.cc
	ModSecurity/src/operators/eq.cc
	ModSecurity/src/operators/validate_url_encoding.cc
	ModSecurity/src/operators/begins_with.cc
	ModSecurity/src/operators/pm_f.cc
	ModSecurity/src/operators/pm_from_file.cc
	ModSecurity/src/operators/validate_byte_range.cc
	ModSecurity/src/operators/within.cc
	ModSecurity/src/operators/str_match.cc
	ModSecurity/src/operators/rbl.cc
	ModSecurity/src/operators/validate_dtd.cc
	ModSecurity/src/operators/rx.cc
	ModSecurity/src/operators/detect_sqli.cc
	ModSecurity/src/operators/ge.cc
	ModSecurity/src/operators/ends_with.cc
	ModSecurity/src/operators/contains_word.cc
	ModSecurity/src/operators/inspect_file.cc
	ModSecurity/src/operators/ip_match.cc
	ModSecurity/src/rules.cc
	ModSecurity/src/modsecurity.cc
	ModSecurity/src/utils/https_client.cc
	ModSecurity/src/utils/random.cc
	ModSecurity/src/utils/md5.cc
	ModSecurity/src/utils/msc_tree.cc
	ModSecurity/src/utils/system.cc
	ModSecurity/src/utils/ip_tree.cc
	ModSecurity/src/utils/shared_files.cc
	ModSecurity/src/utils/regex.cc
	ModSecurity/src/utils/base64.cc
	ModSecurity/src/utils/geo_lookup.cc
	ModSecurity/src/utils/string.cc
	ModSecurity/src/utils/acmp.cc
	ModSecurity/src/utils/sha1.cc
	ModSecurity/src/utils/decode.cc
	ModSecurity/src/variables/xml.cc
	ModSecurity/src/variables/time_epoch.cc
	ModSecurity/src/variables/time_year.cc
	ModSecurity/src/variables/remote_user.cc
	ModSecurity/src/variables/time_sec.cc
	ModSecurity/src/variables/time_day.cc
	ModSecurity/src/variables/duration.cc
	ModSecurity/src/variables/modsec_build.cc
	ModSecurity/src/variables/time_wday.cc
	ModSecurity/src/variables/highest_severity.cc
	ModSecurity/src/variables/time_hour.cc
	ModSecurity/src/variables/env.cc
	ModSecurity/src/variables/time.cc
	ModSecurity/src/variables/variable.cc
	ModSecurity/src/variables/time_mon.cc
	ModSecurity/src/variables/time_min.cc
	ModSecurity/src/variables/tx.cc
	ModSecurity/src/anchored_set_variable.cc
	ModSecurity/src/rules_properties.cc
	ModSecurity/src/rule_message.cc
	ModSecurity/src/engine/lua.cc
	ModSecurity/src/transaction.cc
	ModSecurity/src/request_body_processor/xml.cc
	ModSecurity/src/request_body_processor/multipart.cc
	ModSecurity/src/request_body_processor/json.cc
	ModSecurity/src/rule.cc
	ModSecurity/src/unique_id.cc
	ModSecurity/src/collection/collections.cc
	ModSecurity/src/collection/backend/in_memory-per_process.cc
	ModSecurity/src/collection/backend/lmdb.cc
	ModSecurity/src/parser/seclang-parser.cc
	ModSecurity/src/parser/driver.cc
	ModSecurity/src/parser/seclang-scanner.cc
	ModSecurity/src/rule_script.cc
	ModSecurity/src/audit_log/writer/https.cc
	ModSecurity/src/audit_log/writer/serial.cc
	ModSecurity/src/audit_log/writer/writer.cc
	ModSecurity/src/audit_log/writer/parallel.cc
	ModSecurity/src/audit_log/audit_log.cc
	ModSecurity/src/debug_log/debug_log.cc
	ModSecurity/src/debug_log/debug_log_writer.cc
	ModSecurity/src/actions/no_log.cc
	ModSecurity/src/actions/capture.cc
	ModSecurity/src/actions/init_col.cc
	ModSecurity/src/actions/accuracy.cc
	ModSecurity/src/actions/skip.cc
	ModSecurity/src/actions/rev.cc
	ModSecurity/src/actions/block.cc
	ModSecurity/src/actions/multi_match.cc
	ModSecurity/src/actions/phase.cc
	ModSecurity/src/actions/severity.cc
	ModSecurity/src/actions/transformations/utf8_to_unicode.cc
	ModSecurity/src/actions/transformations/compress_whitespace.cc
	ModSecurity/src/actions/transformations/remove_comments.cc
	ModSecurity/src/actions/transformations/trim_right.cc
	ModSecurity/src/actions/transformations/base64_encode.cc
	ModSecurity/src/actions/transformations/lower_case.cc
	ModSecurity/src/actions/transformations/md5.cc
	ModSecurity/src/actions/transformations/upper_case.cc
	ModSecurity/src/actions/transformations/normalise_path.cc
	ModSecurity/src/actions/transformations/js_decode.cc
	ModSecurity/src/actions/transformations/hex_decode.cc
	ModSecurity/src/actions/transformations/length.cc
	ModSecurity/src/actions/transformations/hex_encode.cc
	ModSecurity/src/actions/transformations/remove_comments_char.cc
	ModSecurity/src/actions/transformations/trim_left.cc
	ModSecurity/src/actions/transformations/trim.cc
	ModSecurity/src/actions/transformations/none.cc
	ModSecurity/src/actions/transformations/replace_nulls.cc
	ModSecurity/src/actions/transformations/remove_whitespace.cc
	ModSecurity/src/actions/transformations/url_decode.cc
	ModSecurity/src/actions/transformations/parity_even_7bit.cc
	ModSecurity/src/actions/transformations/base64_decode.cc
	ModSecurity/src/actions/transformations/escape_seq_decode.cc
	ModSecurity/src/actions/transformations/html_entity_decode.cc
	ModSecurity/src/actions/transformations/remove_nulls.cc
	ModSecurity/src/actions/transformations/transformation.cc
	ModSecurity/src/actions/transformations/url_decode_uni.cc
	ModSecurity/src/actions/transformations/sha1.cc
	ModSecurity/src/actions/transformations/base64_decode_ext.cc
	ModSecurity/src/actions/transformations/parity_zero_7bit.cc
	ModSecurity/src/actions/transformations/sql_hex_decode.cc
	ModSecurity/src/actions/transformations/css_decode.cc
	ModSecurity/src/actions/transformations/parity_odd_7bit.cc
	ModSecurity/src/actions/transformations/normalise_path_win.cc
	ModSecurity/src/actions/transformations/cmd_line.cc
	ModSecurity/src/actions/transformations/url_encode.cc
	ModSecurity/src/actions/transformations/replace_comments.cc
	ModSecurity/src/actions/rule_id.cc
	ModSecurity/src/actions/xmlns.cc
	ModSecurity/src/actions/action.cc
	ModSecurity/src/actions/set_uid.cc
	ModSecurity/src/actions/set_rsc.cc
	ModSecurity/src/actions/skip_after.cc
	ModSecurity/src/actions/chain.cc
	ModSecurity/src/actions/tag.cc
	ModSecurity/src/actions/maturity.cc
	ModSecurity/src/actions/audit_log.cc
	ModSecurity/src/actions/disruptive/pass.cc
	ModSecurity/src/actions/disruptive/allow.cc
	ModSecurity/src/actions/disruptive/deny.cc
	ModSecurity/src/actions/disruptive/redirect.cc
	ModSecurity/src/actions/set_env.cc
	ModSecurity/src/actions/no_audit_log.cc
	ModSecurity/src/actions/log.cc
	ModSecurity/src/actions/exec.cc
	ModSecurity/src/actions/log_data.cc
	ModSecurity/src/actions/ver.cc
	ModSecurity/src/actions/set_var.cc
	ModSecurity/src/actions/set_sid.cc
	ModSecurity/src/actions/ctl/request_body_access.cc
	ModSecurity/src/actions/ctl/request_body_processor_json.cc
	ModSecurity/src/actions/ctl/audit_log_parts.cc
	ModSecurity/src/actions/ctl/request_body_processor_xml.cc
	ModSecurity/src/actions/ctl/rule_remove_target_by_id.cc
	ModSecurity/src/actions/ctl/rule_remove_by_id.cc
	ModSecurity/src/actions/ctl/rule_remove_target_by_tag.cc
	ModSecurity/src/actions/ctl/request_body_processor_urlencoded.cc
	ModSecurity/src/actions/ctl/rule_remove_by_tag.cc
	ModSecurity/src/actions/ctl/rule_engine.cc
	ModSecurity/src/actions/data/status.cc
	ModSecurity/src/actions/msg.cc
	ModSecurity/src/run_time_string.cc
)

add_library(modsecurity SHARED ${SOURCES})
target_include_directories(modsecurity PRIVATE ModSecurity)
target_include_directories(modsecurity PUBLIC ModSecurity/headers)
target_include_directories(modsecurity PUBLIC ModSecurity/others)
target_link_libraries(modsecurity curl mbedtls injection)

# WAF has the worlds most incestous relationship with config.h
target_include_directories(modsecurity PRIVATE include)
target_include_directories(modsecurity PRIVATE include/src)
